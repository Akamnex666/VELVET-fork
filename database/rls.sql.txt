| schemaname | tablename              | policyname                                  | permissive | roles           | cmd    | qual                                                                                                                                                                                                                   | with_check                                                                                                                                                                                                            |
| ---------- | ---------------------- | ------------------------------------------- | ---------- | --------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | addresses              | Users can manage own addresses              | PERMISSIVE | {public}        | ALL    | (auth.uid() = user_id)                                                                                                                                                                                                 | null                                                                                                                                                                                                                  |
| public     | cart_items             | Users can manage own cart                   | PERMISSIVE | {public}        | ALL    | (auth.uid() = user_id)                                                                                                                                                                                                 | null                                                                                                                                                                                                                  |
| public     | categories             | Anyone can view categories                  | PERMISSIVE | {public}        | SELECT | true                                                                                                                                                                                                                   | null                                                                                                                                                                                                                  |
| public     | coupons                | Allow all authenticated read coupons        | PERMISSIVE | {authenticated} | SELECT | (is_active = true)                                                                                                                                                                                                     | null                                                                                                                                                                                                                  |
| public     | newsletter_subscribers | Users can subscribe with email              | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | true                                                                                                                                                                                                                  |
| public     | newsletter_subscribers | Users can update subscription               | PERMISSIVE | {public}        | UPDATE | true                                                                                                                                                                                                                   | null                                                                                                                                                                                                                  |
| public     | order_items            | Users can view own order items              | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM orders
  WHERE ((orders.id = order_items.order_id) AND (orders.user_id = auth.uid()))))                                                                                                     | null                                                                                                                                                                                                                  |
| public     | orders                 | Users can create own orders                 | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                |
| public     | orders                 | Users can view own orders                   | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                 | null                                                                                                                                                                                                                  |
| public     | product_variants       | Admins can insert product variants          | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | ((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND (user_profiles.role = ANY (ARRAY['admin'::user_role, 'super_admin'::user_role])))))) |
| public     | products               | Admins can delete products                  | PERMISSIVE | {public}        | DELETE | (EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND (user_profiles.role = 'admin'::user_role))))                                                                                     | null                                                                                                                                                                                                                  |
| public     | products               | Admins can insert products                  | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | ((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND (user_profiles.role = ANY (ARRAY['admin'::user_role, 'super_admin'::user_role])))))) |
| public     | products               | Anyone can view active products             | PERMISSIVE | {public}        | SELECT | (active = true)                                                                                                                                                                                                        | null                                                                                                                                                                                                                  |
| public     | products               | admin_can_update_products                   | PERMISSIVE | {authenticated} | UPDATE | (EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND (user_profiles.role = 'admin'::user_role))))                                                                                     | null                                                                                                                                                                                                                  |
| public     | products               | admin_can_view_all_products                 | PERMISSIVE | {authenticated} | SELECT | ((EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND (user_profiles.role = 'admin'::user_role)))) OR (active = true))                                                                | null                                                                                                                                                                                                                  |
| public     | reviews                | Users can create own reviews                | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                |
| public     | reviews                | Users can update own reviews                | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                 | null                                                                                                                                                                                                                  |
| public     | reviews                | Users can view all reviews                  | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                                                                   | null                                                                                                                                                                                                                  |
| public     | user_profiles          | Admins can delete profiles                  | PERMISSIVE | {public}        | DELETE | ((EXISTS ( SELECT 1
   FROM user_profiles user_profiles_1
  WHERE ((user_profiles_1.id = auth.uid()) AND (user_profiles_1.role = ANY (ARRAY['admin'::user_role, 'super_admin'::user_role]))))) AND (id <> auth.uid())) | null                                                                                                                                                                                                                  |
| public     | user_profiles          | Allow profile creation                      | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | ((auth.uid() = id) OR (auth.role() = 'service_role'::text) OR (auth.uid() IS NULL))                                                                                                                                   |
| public     | user_profiles          | Enable insert for authentication users only | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | (auth.uid() = id)                                                                                                                                                                                                     |
| public     | user_profiles          | Enable read access for own profile          | PERMISSIVE | {public}        | SELECT | (auth.uid() = id)                                                                                                                                                                                                      | null                                                                                                                                                                                                                  |
| public     | user_profiles          | Enable update for own profile               | PERMISSIVE | {public}        | UPDATE | (auth.uid() = id)                                                                                                                                                                                                      | null                                                                                                                                                                                                                  |
| public     | user_profiles          | Users can insert own profile                | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                   | (auth.uid() = id)                                                                                                                                                                                                     |
| public     | user_profiles          | Users can view own profile                  | PERMISSIVE | {public}        | SELECT | (auth.uid() = id)                                                                                                                                                                                                      | null                                                                                                                                                                                                                  |
| public     | wishlist_items         | Users can manage own wishlist               | PERMISSIVE | {public}        | ALL    | (auth.uid() = user_id)                                                                                                                                                                                                 | null                                                                                                                                                                                                                  |